# LOPHOS Table Schemas

This document defines the column order and data types for the tabular outputs
produced by the LOPHOS phasing pipeline.  Freezing the schema ensures
stability for downstream analyses and unit tests.  Any changes to these
definitions should be accompanied by a corresponding version bump and tests.

## Peak output (`*.peaks.bed`)

Each line corresponds to a single input peak.  Columns are separated by
tab characters and have no header row.

| Column | Name          | Type    | Description                                                     |
|-------:|--------------|---------|-----------------------------------------------------------------|
| 1      | `chrom`       | `str`   | Reference chromosome or contig (e.g. `chr1`)                   |
| 2      | `start`       | `int`   | 0‑based genomic start position                                 |
| 3      | `end`         | `int`   | 0‑based genomic end position                                   |
| 4      | `peak_id`     | `str`   | Peak identifier (from input or autogenerated)                   |
| 5      | `maternal`    | `int`   | Count of maternal reads supporting the peak                    |
| 6      | `paternal`    | `int`   | Count of paternal reads supporting the peak                    |
| 7      | `total`       | `int`   | `maternal + paternal` (informative reads)                      |
| 8      | `log2_ratio`  | `float` | `log2((maternal+pseudocount)/(paternal+pseudocount))`           |
| 9      | `p_value`     | `float` | Two‑sided binomial test p‑value under `p=0.5`                  |
| 10     | `fdr`         | `float` | Benjamini–Hochberg FDR‑adjusted p‑value                        |
| 11     | `bias_call`   | `str`   | Bias classification (`Maternal`, `Paternal`, `Balanced`, `Undetermined`)|

## Loop output (`*.loops.bedpe`)

Each line corresponds to a single input loop (BEDPE format).  Columns are
separated by tab characters and have no header row.

| Column | Name             | Type    | Description                                                     |
|-------:|-----------------|---------|-----------------------------------------------------------------|
| 1      | `chrom1`         | `str`   | Chromosome of the first anchor                                 |
| 2      | `start1`         | `int`   | 0‑based start of the first anchor                              |
| 3      | `end1`           | `int`   | 0‑based end of the first anchor                                |
| 4      | `chrom2`         | `str`   | Chromosome of the second anchor                                |
| 5      | `start2`         | `int`   | 0‑based start of the second anchor                             |
| 6      | `end2`           | `int`   | 0‑based end of the second anchor                               |
| 7      | `loop_id`        | `str`   | Loop identifier (from input or autogenerated)                  |
| 8      | `maternal_pairs` | `int`   | Number of paired reads where both mates are maternal           |
| 9      | `paternal_pairs` | `int`   | Number of paired reads where both mates are paternal           |
| 10     | `ambiguous_pairs`| `int`   | Number of paired reads where mates disagree or RG tags missing |
| 11     | `total_pairs`    | `int`   | `maternal_pairs + paternal_pairs` (informative pairs)          |
| 12     | `log2_ratio_pairs`| `float`| `log2((maternal_pairs+pseudocount)/(paternal_pairs+pseudocount))`|
| 13     | `p_value_pairs`  | `float` | Two‑sided binomial test p‑value under `p=0.5`                  |
| 14     | `fdr_pairs`      | `float` | Benjamini–Hochberg FDR‑adjusted p‑value                        |
| 15     | `bias_call`      | `str`   | Bias classification (`Maternal`, `Paternal`, `Balanced`, `Undetermined`)|

## Quick QC output (`*.quick_qc.tsv`)

The quick QC summary written by ``lophos summary`` or ``lophos phase --summary``
is a TSV with two columns (`metric`, `value`).  Metrics include total counts,
significant feature counts, medians, call breakdowns and thresholds.  See
``lophos/report/summary.py`` for the authoritative list.
